import { useCallback } from "react";
import { toastForbidden } from "../utils/toast";

/**
 * Returns a callable that either executes `fn` or shows a forbidden toast.
 * Usage:
 *   const run = useGuardedAction(canEdit, "Only Admins can edit.");
 *   <button onClick={() => run(() => save(payload))}>Save</button>
 */
export function useGuardedAction(isAllowed, message = "Not allowed.") {
  return useCallback(
    async (fn, ...args) => {
      if (!isAllowed) {
        toastForbidden(message);
        return;
      }
      return await fn(...args);
    },
    [isAllowed, message]
  );
}
