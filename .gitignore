, Csf11Map AS (
  /* Canonical mapping of CSF 1.1 subcategories to each CSF 2.0 subcategory.
     NOTE: If you have a dedicated crosswalk table, replace this with that table.
  */
  SELECT
      v.CSF2SubcategoryID,
      v.CSF1SubcategoryID,
      CSF1SubcategoryName     = MAX(v.CSF1SubcategoryName),
      CSF1SubcategoryLanguage = MAX(v.CSF1SubcategoryLanguage)
  FROM dbo.UI_CsfAttributeFeed v
  WHERE v.CSF1SubcategoryID <> 0
  GROUP BY v.CSF2SubcategoryID, v.CSF1SubcategoryID
)

, Csf11MappedJson =
    (
      SELECT
        m.CSF1SubcategoryID AS id,
        m.CSF1SubcategoryName AS name,
        m.CSF1SubcategoryLanguage AS lang
      FROM Csf11Map m
      WHERE m.CSF2SubcategoryID = t.CSF2SubcategoryID
      ORDER BY m.CSF1SubcategoryID
      FOR JSON PATH
    )
